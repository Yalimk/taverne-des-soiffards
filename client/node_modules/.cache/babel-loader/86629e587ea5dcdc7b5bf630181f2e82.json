{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/virtuoworks/Desktop/taverne-des-soiffards/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/virtuoworks/Desktop/taverne-des-soiffards/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:/Users/virtuoworks/Desktop/taverne-des-soiffards/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/virtuoworks/Desktop/taverne-des-soiffards/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/Users/virtuoworks/Desktop/taverne-des-soiffards/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/virtuoworks/Desktop/taverne-des-soiffards/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";// Native modules import\nimport React,{Component,Fragment}from\"react\";import{Link}from\"react-router-dom\";// Personal modules import\nimport{writeComment,deleteComment}from\"../../logic/post/apiPost\";import{isLoggedIn}from\"../../logic/auth/index\";import defaultProfilePic from\"../../images/default-image.png\";var WriteComment=/*#__PURE__*/function(_Component){_inherits(WriteComment,_Component);var _super=_createSuper(WriteComment);function WriteComment(){var _this;_classCallCheck(this,WriteComment);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={message:\"\",error:\"\"};_this.handleChange=function(event){_this.setState({error:\"\"});_this.setState({message:event.target.value});};_this.isValid=function(){var message=_this.state.message;if(!message.length>0||message.length>300){_this.setState({error:\"Ton commentaire doit être d'au moins 1 caractère et d'au plus 300 caractères, moussaillon !\"});return false;}return true;};_this.addComment=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var userId,token,postId,comment,response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();userId=isLoggedIn().user._id;token=isLoggedIn().token;postId=_this.props.postId;comment={message:_this.state.message};if(isLoggedIn()){_context.next=8;break;}_this.setState({error:\"Tu dois être connecté pour écrire un commentaire, pirate !\"});return _context.abrupt(\"return\",false);case 8:if(!_this.isValid()){_context.next=19;break;}_context.prev=9;_context.next=12;return writeComment(userId,token,postId,comment);case 12:response=_context.sent;if(response.error){console.log(\"[front-end/src/components/post/WriteComment.jsx => addComment] : response.error: \".concat(JSON.stringify(response.error)));}else{_this.setState({message:\"\"});_this.props.updateComments(response.comments);}_context.next=19;break;case 16:_context.prev=16;_context.t0=_context[\"catch\"](9);console.error(\"[front-end/src/components/post/WriteComment.jsx => addComment] : error: \".concat(_context.t0));case 19:case\"end\":return _context.stop();}}},_callee,null,[[9,16]]);}));return function(_x){return _ref.apply(this,arguments);};}();_this.removeComment=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(comment){var userId,token,postId,response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:userId=isLoggedIn().user._id;token=isLoggedIn().token;postId=_this.props.postId;_context2.prev=3;console.log(\"[front-end/src/components/post/WriteComment.jsx => removeComment] : userId: \".concat(userId,\", token: \").concat(token,\", postId: \").concat(postId));_context2.next=7;return deleteComment(userId,token,postId,comment);case 7:response=_context2.sent;if(response.error){console.log(response.error);}else{_this.props.updateComments(response.comments);}_context2.next=14;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](3);console.error(\"[front-end/src/components/post/WriteComment.jsx => removeComment] : error: \".concat(_context2.t0));case 14:case\"end\":return _context2.stop();}}},_callee2,null,[[3,11]]);}));return function(_x2){return _ref2.apply(this,arguments);};}();_this.deleteConfirmation=function(comment){var answer=window.confirm(\"Es-tu sûr de vouloir supprimer ton message, pirate ?\");if(answer){console.log('inside deleteConfirmation');_this.removeComment(comment);}};return _this;}_createClass(WriteComment,[{key:\"render\",value:function render(){var _this2=this;var _this$props=this.props,comments=_this$props.comments,postId=_this$props.postId;var _this$state=this.state,message=_this$state.message,error=_this$state.error;return/*#__PURE__*/_jsxs(\"div\",{className:\"container jumbotron\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"mb-5\",children:\"Donne ton avis sur ce message, moussaillon !\"}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsxs(\"form\",{action:\"\",onSubmit:this.addComment,children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-control\",type:\"text\",value:message,onChange:this.handleChange,placeholder:\"Ecris ici ton avis, bachi-bouzouk...\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-raised btn-success mt-2\",children:\"Envoyer\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-danger\",style:{display:error?\"\":\"none\"},children:error}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-12\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-success mb-4 mt-4\",children:[comments.length,\" \",\"Commentaire\",comments.length<=1?\"\":\"s\"]}),comments.reverse().map(function(comment,i){var _comment$author,_comment$author3,_comment$author4;var commentatorProfile;if(typeof((_comment$author=comment.author)===null||_comment$author===void 0?void 0:_comment$author.pseudo)===\"string\"){var _comment$author2;commentatorProfile=((_comment$author2=comment.author)===null||_comment$author2===void 0?void 0:_comment$author2._id)?\"/user/\".concat(comment.author._id):\"\";}var commentatorPseudo=((_comment$author3=comment.author)===null||_comment$author3===void 0?void 0:_comment$author3.pseudo)?comment.author.pseudo:\"un Inconnu\";return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-12\",style:{padding:0},children:[/*#__PURE__*/_jsx(Link,{to:\"/user/\".concat(comment.author._id),children:/*#__PURE__*/_jsx(\"img\",{style:{borderRadius:\"50%\",border:\"1px solid black\"},className:\"float-left mr-2\",height:\"30px\",width:\"30px\",onError:function onError(img){return img.target.src=\"\".concat(defaultProfilePic);},src:\"\".concat(process.env.REACT_APP_API_URI,\"/user/photo/\").concat(comment.author._id),alt:commentatorPseudo})}),/*#__PURE__*/_jsx(\"p\",{className:\"lead\",children:comment.message})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"font-italic\",style:{fontSize:\"0.7rem\",margin:0},children:[\"Post\\xE9 par\",\" \",/*#__PURE__*/_jsx(Link,{to:typeof commentatorPseudo===\"string\"?commentatorProfile:\"/post/\".concat(postId),style:{color:\"#3BA7BF\"},children:commentatorPseudo}),\" \",\"le \",new Date(comment.created).toLocaleDateString(),isLoggedIn().user&&isLoggedIn().user._id===((_comment$author4=comment.author)===null||_comment$author4===void 0?void 0:_comment$author4._id)&&/*#__PURE__*/_jsx(Fragment,{children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-raised btn-sm btn-danger ml-5\",style:{fontSize:\"0.9rem\",marginBottom:\"15px\",cursor:\"pointer\"},onClick:function onClick(){return _this2.deleteConfirmation(comment);},children:\"Supprimer\"})}),isLoggedIn().user&&isLoggedIn().user.right===process.env.REACT_APP_ADMIN_TITLE&&/*#__PURE__*/_jsx(Fragment,{children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-raised btn-dark font-weight-bold ml-5 btn-sm\",style:{fontSize:\"0.9rem\",marginBottom:\"15px\",cursor:\"pointer\"},onClick:function onClick(){return _this2.deleteConfirmation(comment);},children:\"Supprimer en tant que Roi\"})})]})]}),/*#__PURE__*/_jsx(\"hr\",{})]},i);})]})]});}}]);return WriteComment;}(Component);export default WriteComment;","map":{"version":3,"sources":["C:/Users/virtuoworks/Desktop/taverne-des-soiffards/client/src/components/post/WriteComment.jsx"],"names":["React","Component","Fragment","Link","writeComment","deleteComment","isLoggedIn","defaultProfilePic","WriteComment","state","message","error","handleChange","event","setState","target","value","isValid","length","addComment","preventDefault","userId","user","_id","token","postId","props","comment","response","console","log","JSON","stringify","updateComments","comments","removeComment","deleteConfirmation","answer","window","confirm","display","reverse","map","i","commentatorProfile","author","pseudo","commentatorPseudo","padding","borderRadius","border","img","src","process","env","REACT_APP_API_URI","fontSize","margin","color","Date","created","toLocaleDateString","marginBottom","cursor","right","REACT_APP_ADMIN_TITLE"],"mappings":"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","sourcesContent":["// Native modules import\r\nimport React, { Component, Fragment } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\n// Personal modules import\r\nimport { writeComment, deleteComment } from \"../../logic/post/apiPost\";\r\nimport { isLoggedIn } from \"../../logic/auth/index\";\r\nimport defaultProfilePic from \"../../images/default-image.png\";\r\n\r\nclass WriteComment extends Component {\r\n  state = {\r\n    message: \"\",\r\n    error: \"\",\r\n  };\r\n\r\n  handleChange = (event) => {\r\n    this.setState({\r\n      error: \"\",\r\n    });\r\n    this.setState({\r\n      message: event.target.value,\r\n    });\r\n  };\r\n\r\n  isValid = () => {\r\n    const { message } = this.state;\r\n    if (!message.length > 0 || message.length > 300) {\r\n      this.setState({\r\n        error:\r\n          \"Ton commentaire doit être d'au moins 1 caractère et d'au plus 300 caractères, moussaillon !\",\r\n      });\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n\r\n  addComment = async (event) => {\r\n    event.preventDefault();\r\n    const userId = isLoggedIn().user._id;\r\n    const token = isLoggedIn().token;\r\n    const postId = this.props.postId;\r\n    const comment = { message: this.state.message };\r\n\r\n    if (!isLoggedIn()) {\r\n      this.setState({\r\n        error: \"Tu dois être connecté pour écrire un commentaire, pirate !\",\r\n      });\r\n      return false;\r\n    }\r\n\r\n    if (this.isValid()) {\r\n      try {\r\n        const response = await writeComment(userId, token, postId, comment);\r\n        if (response.error) {\r\n          console.log(\r\n            `[front-end/src/components/post/WriteComment.jsx => addComment] : response.error: ${JSON.stringify(\r\n              response.error\r\n            )}`\r\n          );\r\n        } else {\r\n          this.setState({\r\n            message: \"\",\r\n          });\r\n          this.props.updateComments(response.comments);\r\n        }\r\n      } catch (error) {\r\n        console.error(\r\n          `[front-end/src/components/post/WriteComment.jsx => addComment] : error: ${error}`\r\n        );\r\n      }\r\n    }\r\n  };\r\n\r\n  removeComment = async (comment) => {\r\n    const userId = isLoggedIn().user._id;\r\n    const token = isLoggedIn().token;\r\n    const postId = this.props.postId;\r\n    try {\r\n      console.log(`[front-end/src/components/post/WriteComment.jsx => removeComment] : userId: ${userId}, token: ${token}, postId: ${postId}`);\r\n      const response = await deleteComment(userId, token, postId, comment);\r\n      if (response.error) {\r\n        console.log(response.error);\r\n      } else {\r\n        this.props.updateComments(response.comments);\r\n      }\r\n    } catch (error) {\r\n      console.error(\r\n        `[front-end/src/components/post/WriteComment.jsx => removeComment] : error: ${error}`\r\n      );\r\n    }\r\n  };\r\n\r\n  deleteConfirmation = (comment) => {\r\n    let answer = window.confirm(\r\n      \"Es-tu sûr de vouloir supprimer ton message, pirate ?\"\r\n    );\r\n    if (answer) {\r\n      console.log('inside deleteConfirmation')\r\n      this.removeComment(comment);\r\n    }\r\n  };\r\n\r\n  render() {\r\n    const { comments, postId } = this.props;\r\n    const { message, error } = this.state;\r\n\r\n    return (\r\n      <div className=\"container jumbotron\">\r\n        <h2 className=\"mb-5\">Donne ton avis sur ce message, moussaillon !</h2>\r\n        <div className=\"form-group\">\r\n          <form action=\"\" onSubmit={this.addComment}>\r\n            <input\r\n              className=\"form-control\"\r\n              type=\"text\"\r\n              value={message}\r\n              onChange={this.handleChange}\r\n              placeholder=\"Ecris ici ton avis, bachi-bouzouk...\"\r\n            />\r\n            <button type=\"submit\" className=\"btn btn-raised btn-success mt-2\">\r\n              Envoyer\r\n            </button>\r\n          </form>\r\n        </div>\r\n        <div\r\n          className=\"alert alert-danger\"\r\n          style={{ display: error ? \"\" : \"none\" }}\r\n        >\r\n          {error}\r\n        </div>\r\n        {/* {JSON.stringify(comments)} */}\r\n        <div className=\"col-md-12\">\r\n          <h3 className=\"text-success mb-4 mt-4\">\r\n            {comments.length}{\" \"}Commentaire{comments.length <= 1 ? \"\" : \"s\"}\r\n          </h3>\r\n          {comments.reverse().map((comment, i) => {\r\n            let commentatorProfile;\r\n            if (typeof comment.author?.pseudo === \"string\") {\r\n              commentatorProfile = comment.author?._id\r\n                ? `/user/${comment.author._id}`\r\n                : \"\";\r\n            }\r\n            const commentatorPseudo = comment.author?.pseudo\r\n              ? comment.author.pseudo\r\n              : \"un Inconnu\";\r\n            return (\r\n              <div key={i}>\r\n                <div className=\"row\">\r\n                  <div className=\"col-md-12\" style={{ padding: 0 }}>\r\n                    <Link to={`/user/${comment.author._id}`}>\r\n                      <img\r\n                        style={{\r\n                          borderRadius: \"50%\",\r\n                          border: \"1px solid black\",\r\n                        }}\r\n                        className=\"float-left mr-2\"\r\n                        height=\"30px\"\r\n                        width=\"30px\"\r\n                        onError={(img) =>\r\n                          (img.target.src = `${defaultProfilePic}`)\r\n                        }\r\n                        src={`${process.env.REACT_APP_API_URI}/user/photo/${comment.author._id}`}\r\n                        alt={commentatorPseudo}\r\n                      />\r\n                    </Link>\r\n                    <p className=\"lead\">\r\n                      {comment.message}\r\n                    </p>\r\n                  </div>\r\n                  <p\r\n                    className=\"font-italic\"\r\n                    style={{ fontSize: \"0.7rem\", margin: 0 }}\r\n                  >\r\n                    Posté par{\" \"}\r\n                    <Link\r\n                      to={\r\n                        typeof commentatorPseudo === \"string\"\r\n                          ? commentatorProfile\r\n                          : `/post/${postId}`\r\n                      }\r\n                      style={{ color: \"#3BA7BF\" }}\r\n                    >\r\n                      {commentatorPseudo}\r\n                    </Link>{\" \"}\r\n                    le {new Date(comment.created).toLocaleDateString()}\r\n                    {isLoggedIn().user &&\r\n                      isLoggedIn().user._id === comment.author?._id && (\r\n                        <Fragment>\r\n                          <button\r\n                            className=\"btn btn-raised btn-sm btn-danger ml-5\"\r\n                            style={{\r\n                              fontSize: \"0.9rem\",\r\n                              marginBottom: \"15px\",\r\n                              cursor: \"pointer\",\r\n                            }}\r\n                            onClick={() => this.deleteConfirmation(comment)}\r\n                          >\r\n                            Supprimer\r\n                          </button>\r\n                        </Fragment>\r\n                      )}\r\n                      {/* {console.log('user.right', isLoggedIn().user.right)} */}\r\n                      {/* {console.log('ADMIN_TITLE', process.env.REACT_APP_ADMIN_TITLE)} */}\r\n                    {isLoggedIn().user &&\r\n                      isLoggedIn().user.right ===\r\n                        process.env.REACT_APP_ADMIN_TITLE && (\r\n                        <Fragment>\r\n                          <button\r\n                            className=\"btn btn-raised btn-dark font-weight-bold ml-5 btn-sm\"\r\n                            style={{\r\n                              fontSize: \"0.9rem\",\r\n                              marginBottom: \"15px\",\r\n                              cursor: \"pointer\",\r\n                            }}\r\n                            onClick={() => this.deleteConfirmation(comment)}\r\n                          >\r\n                            Supprimer en tant que Roi\r\n                          </button>\r\n                        </Fragment>\r\n                      )}\r\n                  </p>\r\n                </div>\r\n                <hr />\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default WriteComment;\r\n"]},"metadata":{},"sourceType":"module"}