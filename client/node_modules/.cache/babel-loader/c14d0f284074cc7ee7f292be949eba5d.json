{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/virtuoworks/Desktop/taverne-des-soiffards/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/virtuoworks/Desktop/taverne-des-soiffards/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:/Users/virtuoworks/Desktop/taverne-des-soiffards/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/virtuoworks/Desktop/taverne-des-soiffards/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/Users/virtuoworks/Desktop/taverne-des-soiffards/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/virtuoworks/Desktop/taverne-des-soiffards/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";// Native modules import\nimport React,{Component}from\"react\";import{Link}from\"react-router-dom\";// Personal modules import\nimport{postsPerPage}from\"../../logic/post/apiPost\";import defaultPostPic from\"../../images/beautiful-sea.jpg\";var Posts=/*#__PURE__*/function(_Component){_inherits(Posts,_Component);var _super=_createSuper(Posts);function Posts(){var _this;_classCallCheck(this,Posts);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={posts:[],page:1};_this.loadPosts=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(page){var allPosts;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return postsPerPage(page);case 3:allPosts=_context.sent;// console.log('allPosts in loadPosts in Post.jsx', allPosts)\n// console.log('type of allPosts in loadPosts in Post.jsx', typeof allPosts)\nif(allPosts){_this.setState({posts:allPosts});}else{console.error(\"No posts were retrieved from the server because of error.\");}_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.error(\"Couldn't change state of posts because of error: \".concat(_context.t0,\".\"));case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);}));return function(_x){return _ref.apply(this,arguments);};}();_this.showMorePosts=function(num){_this.setState({page:_this.state.page+1});_this.loadPosts(_this.state.page+num);};_this.showLessPosts=function(num){_this.setState({page:_this.state.page-1});_this.loadPosts(_this.state.page-num);};_this.renderPosts=function(posts){// console.log(\"posts.length\", posts.length);\nreturn/*#__PURE__*/_jsx(\"div\",{className:\"row\",style:{justifyContent:\"center\"},children:posts.map(function(post,i){var posterProfile=post.author?\"/user/\".concat(post.author._id):\"/posts\";var posterPseudo=post.author?post.author.pseudo:\"un Inconnu\";return/*#__PURE__*/_jsxs(\"div\",{className:\"card card-block col-sm-12 col-md-6 col-lg-4 col-xl-3\",style:{backgroundColor:\"#D9D9D9\",marginRight:\"30px\",marginBottom:\"30px\",boxShadow:\"3px 3px 5px grey\",width:\"300px\",borderRadius:\"3%\"},children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-body text-center\",children:/*#__PURE__*/_jsx(\"img\",{className:\"img-thumbnail mb-3\",style:{height:\"auto\",width:\"auto\",boxShadow:\"3px 3px 10px grey\"},src:\"\".concat(process.env.REACT_APP_API_URI,\"/post/photo/\").concat(post._id),alt:post.title,onError:function onError(img){return img.target.src=\"\".concat(defaultPostPic);}})},i),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"h5\",{className:\"card-title text-center font-weight-bold mb-3\",children:post.title}),/*#__PURE__*/_jsx(\"p\",{className:\"card-text text-justify mb-5\",children:post.body.substring(0,100)}),/*#__PURE__*/_jsxs(\"p\",{className:\"font-italic mb-0\",children:[\"Post\\xE9 par \",/*#__PURE__*/_jsx(Link,{to:posterProfile,style:{color:\"#3BA7BF\"},children:posterPseudo}),\" le\",\" \",new Date(post.created).toLocaleDateString('fr-FR')]}),/*#__PURE__*/_jsx(Link,{to:\"/post/\".concat(post._id),className:\"btn btn-lg btn-block btn-outline-success text-center font-weight-bold mb-3\",children:\"Lire plus\"})]},i);})});};return _this;}_createClass(Posts,[{key:\"componentDidMount\",value:function componentDidMount(){this.loadPosts(this.state.page);}},{key:\"render\",value:function render(){var _this2=this;var _this$state=this.state,posts=_this$state.posts,page=_this$state.page;return/*#__PURE__*/_jsxs(\"div\",{className:\"jumbotron\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"mt-3 mb-5 text-center\",style:{fontWeight:\"bold\"},children:!posts.length?\"Rien à afficher pour le moment...\":\"Messages des Pirates de la Taverne des Soiffards\"}),this.renderPosts(posts),/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col text-right\",children:page>1?/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-raised btn-info mt-5 mb-5\",onClick:function onClick(){return _this2.showLessPosts(1);},style:{boxShadow:\"3px 3px 5px grey\"},children:\"Page pr\\xE9c\\xE9dente\"}):\"\"}),/*#__PURE__*/_jsx(\"div\",{className:\"col text-left\",children:posts.length>page&&posts.length===Number(process.env.REACT_APP_PER_PAGE)?/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-raised btn-info mt-5 mb-5\",onClick:function onClick(){return _this2.showMorePosts(1);},style:{boxShadow:\"3px 3px 5px grey\"},children:\"Page suivante\"}):\"\"})]})]});}}]);return Posts;}(Component);export default Posts;","map":{"version":3,"sources":["C:/Users/virtuoworks/Desktop/taverne-des-soiffards/front-end/src/pages/post/Posts.jsx"],"names":["React","Component","Link","postsPerPage","defaultPostPic","Posts","state","posts","page","loadPosts","allPosts","setState","console","error","showMorePosts","num","showLessPosts","renderPosts","justifyContent","map","post","i","posterProfile","author","_id","posterPseudo","pseudo","backgroundColor","marginRight","marginBottom","boxShadow","width","borderRadius","height","process","env","REACT_APP_API_URI","title","img","target","src","body","substring","color","Date","created","toLocaleDateString","fontWeight","length","Number","REACT_APP_PER_PAGE"],"mappings":"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","sourcesContent":["// Native modules import\r\nimport React, { Component } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\n// Personal modules import\r\nimport { postsPerPage } from \"../../logic/post/apiPost\";\r\nimport defaultPostPic from \"../../images/beautiful-sea.jpg\";\r\n\r\nclass Posts extends Component {\r\n  state = {\r\n    posts: [],\r\n    page: 1,\r\n  };\r\n\r\n  loadPosts = async (page) => {\r\n    try {\r\n      const allPosts = await postsPerPage(page);\r\n      // console.log('allPosts in loadPosts in Post.jsx', allPosts)\r\n      // console.log('type of allPosts in loadPosts in Post.jsx', typeof allPosts)\r\n      if (allPosts) {\r\n        this.setState({\r\n          posts: allPosts,\r\n        });\r\n      } else {\r\n        console.error(\r\n          `No posts were retrieved from the server because of error.`\r\n        );\r\n      }\r\n    } catch (error) {\r\n      console.error(\r\n        `Couldn't change state of posts because of error: ${error}.`\r\n      );\r\n    }\r\n  };\r\n\r\n  showMorePosts = (num) => {\r\n    this.setState({ page: this.state.page + 1 });\r\n    this.loadPosts(this.state.page + num);\r\n  };\r\n\r\n  showLessPosts = (num) => {\r\n    this.setState({ page: this.state.page - 1 });\r\n    this.loadPosts(this.state.page - num);\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.loadPosts(this.state.page);\r\n  }\r\n\r\n  renderPosts = (posts) => {\r\n    // console.log(\"posts.length\", posts.length);\r\n    return (\r\n      <div className=\"row\" style={{ justifyContent: \"center\" }}>\r\n        {posts.map((post, i) => {\r\n          const posterProfile = post.author ? `/user/${post.author._id}` : \"/posts\";\r\n          const posterPseudo = post.author ? post.author.pseudo : \"un Inconnu\";\r\n\r\n          return (\r\n            <div\r\n              className=\"card card-block col-sm-12 col-md-6 col-lg-4 col-xl-3\"\r\n              key={i}\r\n              style={{\r\n                backgroundColor: \"#D9D9D9\",\r\n                marginRight: \"30px\",\r\n                marginBottom: \"30px\",\r\n                boxShadow: \"3px 3px 5px grey\",\r\n                width: \"300px\",\r\n                borderRadius: \"3%\"\r\n              }}\r\n            >\r\n              <div className=\"card-body text-center\" key={i}>\r\n                <img\r\n                  className=\"img-thumbnail mb-3\"\r\n                  style={{ height: \"auto\", width: \"auto\", boxShadow: \"3px 3px 10px grey\" }}\r\n                  src={`${process.env.REACT_APP_API_URI}/post/photo/${post._id}`}\r\n                  alt={post.title}\r\n                  onError={(img) => (img.target.src = `${defaultPostPic}`)}\r\n                />\r\n              </div>\r\n              <hr />\r\n              <h5 className=\"card-title text-center font-weight-bold mb-3\">\r\n                {post.title}\r\n              </h5>\r\n              <p className=\"card-text text-justify mb-5\">\r\n                {post.body.substring(0, 100)}\r\n              </p>\r\n              <p className=\"font-italic mb-0\">\r\n                Posté par <Link to={posterProfile} style={{color: \"#3BA7BF\"}}>{posterPseudo}</Link> le{\" \"}\r\n                {new Date(post.created).toLocaleDateString('fr-FR')}\r\n              </p>\r\n              <Link\r\n                to={`/post/${post._id}`}\r\n                className=\"btn btn-lg btn-block btn-outline-success text-center font-weight-bold mb-3\"\r\n              >\r\n                Lire plus\r\n              </Link>\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  render() {\r\n    const { posts, page } = this.state;\r\n    return (\r\n      <div className=\"jumbotron\">\r\n        <h2 className=\"mt-3 mb-5 text-center\" style={{ fontWeight: \"bold\" }}>\r\n          {!posts.length\r\n            ? \"Rien à afficher pour le moment...\"\r\n            : \"Messages des Pirates de la Taverne des Soiffards\"}\r\n        </h2>\r\n        {this.renderPosts(posts)}\r\n\r\n        <div className=\"row\">\r\n          <div className=\"col text-right\">\r\n            {page > 1 ? (\r\n              <button\r\n                className=\"btn btn-raised btn-info mt-5 mb-5\"\r\n                onClick={() => this.showLessPosts(1)}\r\n                style={{ boxShadow: \"3px 3px 5px grey\" }}\r\n              >\r\n                Page précédente\r\n              </button>\r\n            ) : (\r\n              \"\"\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"col text-left\">\r\n            {(posts.length > page && posts.length === Number(process.env.REACT_APP_PER_PAGE)) ? (\r\n              <button\r\n                className=\"btn btn-raised btn-info mt-5 mb-5\"\r\n                onClick={() => this.showMorePosts(1)}\r\n                style={{ boxShadow: \"3px 3px 5px grey\" }}\r\n              >\r\n                Page suivante\r\n              </button>\r\n            ) : (\r\n              \"\"\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Posts;\r\n"]},"metadata":{},"sourceType":"module"}