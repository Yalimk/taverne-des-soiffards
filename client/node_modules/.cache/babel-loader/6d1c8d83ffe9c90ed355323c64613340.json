{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/virtuoworks/Desktop/taverne-des-soiffards/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/virtuoworks/Desktop/taverne-des-soiffards/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:/Users/virtuoworks/Desktop/taverne-des-soiffards/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/virtuoworks/Desktop/taverne-des-soiffards/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/Users/virtuoworks/Desktop/taverne-des-soiffards/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/virtuoworks/Desktop/taverne-des-soiffards/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";// Native modules import\nimport React,{Component}from\"react\";import{Redirect,Link}from\"react-router-dom\";// Components import\nimport DeleteUser from\"../../components/user/DeleteUser\";import UserPosts from\"../../components/user/UserPosts\";// Personal modules import\nimport{isLoggedIn}from\"../../logic/auth/index\";import{read}from\"../../logic/user/apiUser\";import defaultProfilePic from\"../../images/default-image.png\";import{listUserPosts}from\"../../logic/post/apiPost\";var Profile=/*#__PURE__*/function(_Component){_inherits(Profile,_Component);var _super=_createSuper(Profile);function Profile(){var _this;_classCallCheck(this,Profile);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={user:\"\",redirectionSignIn:false,posts:[]};_this.init=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(userId){var token,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;token=isLoggedIn().token;// console.log(`[front-end/src/user/Profile.jsx => init] : token: ${token}`)\n// console.log(`[front-end/src/user/Profile.jsx => init] : userId: ${userId}`)\n_context.next=4;return read(userId,token);case 4:data=_context.sent;if(data.error){console.error(\"[front-end/src/user/Profile.jsx => init:28] : data.error: \".concat(data.error));_this.setState={redirectionSignIn:true};}else{// console.log(`[front-end/src/user/Profile.jsx => init:28] : data: ${data}`);\n_this.setState({user:data});// console.log(`[front-end/src/user/Profile.jsx => init:37] : data._id: ${data._id}.`);\n_this.loadPosts(data._id);}_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);console.error(\"[front-end/src/user/Profile.jsx => init:40] : error: \".concat(_context.t0,\".\"));case 11:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}));return function(_x){return _ref.apply(this,arguments);};}();_this.loadPosts=function(userId){var token=isLoggedIn().token;listUserPosts(userId,token).then(function(data){if(data.error){console.log(data.error);}else{_this.setState({posts:data});}});};return _this;}_createClass(Profile,[{key:\"componentDidMount\",value:function componentDidMount(){try{var userId=this.props.match.params.userId;// console.log(`[front-end/src/user/Profile.jsx => componentDidMount] userId: ${userId}`);\nif(userId){this.init(userId);}else{console.error(\"No userId found.\");}}catch(error){console.error(\"Something went wrong with componentDidMount method.\");}}},{key:\"componentWillReceiveProps\",value:function componentWillReceiveProps(props){try{var userId=props.match.params.userId;if(userId){this.init(userId);}else{console.error(\"No userId found.\");}}catch(error){console.error(\"Something went wrong with componentWillReceiveProps method.\");}}},{key:\"render\",value:function render(){var _this$state=this.state,redirectionSignIn=_this$state.redirectionSignIn,user=_this$state.user,posts=_this$state.posts;var _id=user._id,pseudo=user.pseudo,email=user.email,photo=user.photo,about=user.about,created=user.created,role=user.role,hobbies=user.hobbies;// console.log('user.about dans render de Profile: ', user.about);\n// console.log('user dans render de Profile: ', user);\nif(redirectionSignIn){return/*#__PURE__*/_jsx(Redirect,{to:\"/signin\"});}if(photo){var photoUrl=_id?\"\".concat(process.env.REACT_APP_API_URI,\"/user/photo/\").concat(_id,\"?\").concat(new Date().getTime()):defaultProfilePic;return/*#__PURE__*/_jsxs(\"div\",{className:\"container jumbotron\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"mb-5\",children:pseudo}),/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-md-4\",children:/*#__PURE__*/_jsx(\"img\",{style:{height:\"300px\",width:\"auto\",borderRadius:\"25%\",boxShadow:\"3px 3px 10px grey\"},className:\"img-thumbnail\",src:photoUrl,onError:function onError(img){return img.target.src=\"\".concat(defaultProfilePic);},alt:pseudo})}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"lead mt-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"container row\",children:[/*#__PURE__*/_jsx(\"p\",{style:{fontWeight:\"bold\"},children:\"Inscription :\\xA0\"}),/*#__PURE__*/_jsx(\"p\",{children:\" \".concat(new Date(created).toLocaleDateString('fr-FR'))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"container row\",children:[/*#__PURE__*/_jsx(\"p\",{style:{fontWeight:\"bold\"},children:\"Email :\\xA0\"}),/*#__PURE__*/_jsx(\"p\",{children:email})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"container row\",children:[/*#__PURE__*/_jsx(\"p\",{style:{fontWeight:\"bold\"},children:\"R\\xF4le favori :\\xA0\"}),/*#__PURE__*/_jsx(\"p\",{children:role})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"container row\",children:[/*#__PURE__*/_jsx(\"p\",{style:{fontWeight:\"bold\"},children:\"Loisirs :\\xA0\"}),/*#__PURE__*/_jsx(\"p\",{children:hobbies})]})]}),isLoggedIn().user&&isLoggedIn().user._id===_id&&/*#__PURE__*/_jsxs(\"div\",{className:\"d-inline-block\",children:[/*#__PURE__*/_jsx(Link,{to:\"/post/create\",className:\"btn btn-raised btn-info mr-5 mb-3\",children:\"Poster un message\"}),/*#__PURE__*/_jsx(Link,{to:\"/user/edit/\".concat(_id),className:\"btn btn-raised btn-success mr-5 mb-3\",children:\"Modifier les informations\"}),/*#__PURE__*/_jsx(DeleteUser,{userId:_id})]}),/*#__PURE__*/_jsx(\"div\",{children:isLoggedIn().user&&isLoggedIn().user.right===process.env.REACT_APP_ADMIN_TITLE&&/*#__PURE__*/_jsx(\"div\",{className:\"card mt-5 jumbotron\",style:{boxShadow:\"3px 3px 10px grey\",borderRadius:\"10%\",backgroundColor:\"#D9D9D9\",padding:\"32px\"},children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"card-title mb-3\",style:{color:\"#9662E3\",fontWeight:\"bold\"},children:\"Interface du Roi des Pirates\"}),/*#__PURE__*/_jsx(Link,{className:\"btn btn-raised btn-light mr-5 font-weight-bold\",to:\"/user/edit/\".concat(_id),style:{color:\"black\"},children:\"Modifier en tant que Roi\"}),/*#__PURE__*/_jsx(DeleteUser,{userId:_id})]})})})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-12 mt-5\",children:[/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"p\",{className:\"lead\",style:{fontWeight:\"bold\"},children:\"A propos de moi :\\xA0\"}),/*#__PURE__*/_jsx(\"p\",{className:\"lead\",children:about}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(UserPosts,{posts:posts})]})})]});}else{return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"mb-5 mt-5\",children:pseudo}),/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-md-4\",children:/*#__PURE__*/_jsx(\"img\",{style:{height:\"300px\",width:\"auto\",borderRadius:\"25%\"},className:\"img-thumbnail\",src:\"\".concat(defaultProfilePic),onError:function onError(img){return img.target.src=\"\".concat(defaultProfilePic);},alt:pseudo})}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"lead mt-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"container row\",children:[/*#__PURE__*/_jsx(\"p\",{style:{fontWeight:\"bold\"},children:\"Inscription :\\xA0\"}),/*#__PURE__*/_jsx(\"p\",{children:\" \".concat(new Date(created).toLocaleDateString('fr-FR'))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"container row\",children:[/*#__PURE__*/_jsx(\"p\",{style:{fontWeight:\"bold\"},children:\"Email :\\xA0\"}),/*#__PURE__*/_jsx(\"p\",{children:email})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"container row\",children:[/*#__PURE__*/_jsx(\"p\",{style:{fontWeight:\"bold\"},children:\"R\\xF4le favori :\\xA0\"}),/*#__PURE__*/_jsx(\"p\",{children:role})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"container row\",children:[/*#__PURE__*/_jsx(\"p\",{style:{fontWeight:\"bold\"},children:\"Loisirs :\\xA0\"}),/*#__PURE__*/_jsx(\"p\",{children:hobbies})]})]}),isLoggedIn().user&&isLoggedIn().user._id===_id&&/*#__PURE__*/_jsxs(\"div\",{className:\"d-inline-block\",children:[/*#__PURE__*/_jsx(Link,{to:\"/post/create\",className:\"btn btn-raised btn-info mr-5 mb-3\",children:\"Poster un message\"}),/*#__PURE__*/_jsx(Link,{to:\"/user/edit/\".concat(_id),className:\"btn btn-raised btn-success mr-5 mb-3\",children:\"Modifier les informations\"}),/*#__PURE__*/_jsx(DeleteUser,{userId:_id})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-12 mt-5\",children:[/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"p\",{className:\"lead\",children:about}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(UserPosts,{posts:posts})]})})]});}}}]);return Profile;}(Component);export default Profile;","map":{"version":3,"sources":["C:/Users/virtuoworks/Desktop/taverne-des-soiffards/client/src/pages/user/Profile.jsx"],"names":["React","Component","Redirect","Link","DeleteUser","UserPosts","isLoggedIn","read","defaultProfilePic","listUserPosts","Profile","state","user","redirectionSignIn","posts","init","userId","token","data","error","console","setState","loadPosts","_id","then","log","props","match","params","pseudo","email","photo","about","created","role","hobbies","photoUrl","process","env","REACT_APP_API_URI","Date","getTime","height","width","borderRadius","boxShadow","img","target","src","fontWeight","toLocaleDateString","right","REACT_APP_ADMIN_TITLE","backgroundColor","padding","color"],"mappings":"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","sourcesContent":["// Native modules import\r\nimport React, { Component } from \"react\";\r\nimport { Redirect, Link } from \"react-router-dom\";\r\n\r\n// Components import\r\nimport DeleteUser from \"../../components/user/DeleteUser\";\r\nimport UserPosts from \"../../components/user/UserPosts\";\r\n\r\n// Personal modules import\r\nimport { isLoggedIn } from \"../../logic/auth/index\";\r\nimport { read } from \"../../logic/user/apiUser\";\r\nimport defaultProfilePic from \"../../images/default-image.png\";\r\nimport { listUserPosts } from \"../../logic/post/apiPost\";\r\n\r\nclass Profile extends Component {\r\n  state = {\r\n    user: \"\",\r\n    redirectionSignIn: false,\r\n    posts: [],\r\n  };\r\n\r\n  init = async (userId) => {\r\n    try {\r\n      const token = isLoggedIn().token;\r\n      // console.log(`[front-end/src/user/Profile.jsx => init] : token: ${token}`)\r\n      // console.log(`[front-end/src/user/Profile.jsx => init] : userId: ${userId}`)\r\n      const data = await read(userId, token);\r\n      if (data.error) {\r\n        console.error(`[front-end/src/user/Profile.jsx => init:28] : data.error: ${data.error}`)\r\n        this.setState = {\r\n          redirectionSignIn: true,\r\n        };\r\n      } else {\r\n        // console.log(`[front-end/src/user/Profile.jsx => init:28] : data: ${data}`);\r\n        this.setState({\r\n          user: data,\r\n        });\r\n        // console.log(`[front-end/src/user/Profile.jsx => init:37] : data._id: ${data._id}.`);\r\n        this.loadPosts(data._id);\r\n      }\r\n    } catch (error) {\r\n      console.error(\r\n        `[front-end/src/user/Profile.jsx => init:40] : error: ${error}.`\r\n      );\r\n    }\r\n  };\r\n\r\n  loadPosts = (userId) => {\r\n    const token = isLoggedIn().token;\r\n    listUserPosts(userId, token).then((data) => {\r\n      if (data.error) {\r\n        console.log(data.error);\r\n      } else {\r\n        this.setState({ posts: data });\r\n      }\r\n    });\r\n  };\r\n\r\n  componentDidMount() {\r\n    try {\r\n      const userId = this.props.match.params.userId;\r\n      // console.log(`[front-end/src/user/Profile.jsx => componentDidMount] userId: ${userId}`);\r\n      if (userId) {\r\n        this.init(userId);\r\n      } else {\r\n        console.error(\"No userId found.\");\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Something went wrong with componentDidMount method.\");\r\n    }\r\n  };\r\n\r\n  componentWillReceiveProps(props) {\r\n    try {\r\n      const userId = props.match.params.userId;\r\n      if (userId) {\r\n        this.init(userId);\r\n      } else {\r\n        console.error(\"No userId found.\");\r\n      }\r\n    } catch (error) {\r\n      console.error(\r\n        \"Something went wrong with componentWillReceiveProps method.\"\r\n      );\r\n    }\r\n  };\r\n\r\n  render() {\r\n    const { redirectionSignIn, user, posts } = this.state;\r\n    const { _id, pseudo, email, photo, about, created, role, hobbies } = user;\r\n    // console.log('user.about dans render de Profile: ', user.about);\r\n    // console.log('user dans render de Profile: ', user);\r\n    if (redirectionSignIn) {\r\n      return <Redirect to=\"/signin\" />;\r\n    }\r\n\r\n    if (photo) {\r\n      const photoUrl = _id\r\n        ? `${\r\n            process.env.REACT_APP_API_URI\r\n          }/user/photo/${_id}?${new Date().getTime()}`\r\n        : defaultProfilePic;\r\n\r\n      return (\r\n        <div className=\"container jumbotron\">\r\n          <h3 className=\"mb-5\">{pseudo}</h3>\r\n          <div className=\"row\">\r\n            <div className=\"col-md-4\">\r\n              <img\r\n                style={{ height: \"300px\", width: \"auto\", borderRadius: \"25%\", boxShadow: \"3px 3px 10px grey\" }}\r\n                className=\"img-thumbnail\"\r\n                src={photoUrl}\r\n                onError={(img) => (img.target.src = `${defaultProfilePic}`)}\r\n                alt={pseudo}\r\n              />\r\n            </div>\r\n\r\n            <div className=\"col-md-8\">\r\n              <div className=\"lead mt-2\">\r\n                <div className=\"container row\">\r\n                  <p style={{ fontWeight: \"bold\" }}>Inscription :&nbsp;</p>\r\n                  <p>{` ${new Date(created).toLocaleDateString('fr-FR')}`}</p>\r\n                </div>\r\n\r\n                <div className=\"container row\">\r\n                  <p style={{ fontWeight: \"bold\" }}>Email :&nbsp;</p>\r\n                  <p>{email}</p>\r\n                </div>\r\n\r\n                <div className=\"container row\">\r\n                  <p style={{ fontWeight: \"bold\" }}>Rôle favori :&nbsp;</p>\r\n                  <p>{role}</p>\r\n                </div>\r\n\r\n                <div className=\"container row\">\r\n                  <p style={{ fontWeight: \"bold\" }}>Loisirs :&nbsp;</p>\r\n                  <p>{hobbies}</p>\r\n                </div>\r\n              </div>\r\n\r\n              {isLoggedIn().user && isLoggedIn().user._id === _id && (\r\n                <div className=\"d-inline-block\">\r\n                  <Link\r\n                    to={`/post/create`}\r\n                    className=\"btn btn-raised btn-info mr-5 mb-3\"\r\n                  >\r\n                    Poster un message\r\n                  </Link>\r\n                  <Link\r\n                    to={`/user/edit/${_id}`}\r\n                    className=\"btn btn-raised btn-success mr-5 mb-3\"\r\n                  >\r\n                    Modifier les informations\r\n                  </Link>\r\n                  <DeleteUser userId={_id} />\r\n                </div>\r\n              )}\r\n              <div>\r\n                {isLoggedIn().user &&\r\n                  isLoggedIn().user.right === process.env.REACT_APP_ADMIN_TITLE && (\r\n                    <div\r\n                      className=\"card mt-5 jumbotron\"\r\n                      style={{\r\n                        boxShadow: \"3px 3px 10px grey\",\r\n                        borderRadius: \"10%\", \r\n                        backgroundColor:\"#D9D9D9\",\r\n                        padding: \"32px\"\r\n\r\n                      }}\r\n                    >\r\n                      <div className=\"card-body\">\r\n                        <h5\r\n                          className=\"card-title mb-3\"\r\n                          style={{ color: \"#9662E3\", fontWeight: \"bold\" }}\r\n                        >\r\n                          Interface du Roi des Pirates\r\n                        </h5>\r\n                        <Link\r\n                          className=\"btn btn-raised btn-light mr-5 font-weight-bold\"\r\n                          to={`/user/edit/${_id}`}\r\n                          style={{color: \"black\"}}\r\n                        >\r\n                          Modifier en tant que Roi\r\n                        </Link>\r\n                        <DeleteUser userId={_id} />\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className=\"row\">\r\n            <div className=\"col-md-12 mt-5\">\r\n              <hr />\r\n              <p className=\"lead\" style={{ fontWeight: \"bold\" }}>\r\n                A propos de moi :&nbsp;\r\n              </p>\r\n              <p className=\"lead\">{about}</p>\r\n              <hr />\r\n\r\n              <UserPosts posts={posts} />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      );\r\n    } else {\r\n      return (\r\n        <div className=\"container\">\r\n          <h3 className=\"mb-5 mt-5\">{pseudo}</h3>\r\n          <div className=\"row\">\r\n          <div className=\"col-md-4\">\r\n              <img\r\n                style={{ height: \"300px\", width: \"auto\", borderRadius: \"25%\" }}\r\n                className=\"img-thumbnail\"\r\n                src={`${defaultProfilePic}`}\r\n                onError={(img) => (img.target.src = `${defaultProfilePic}`)}\r\n                alt={pseudo}\r\n              />\r\n            </div>\r\n\r\n            <div className=\"col-md-8\">\r\n              <div className=\"lead mt-2\">\r\n                <div className=\"container row\">\r\n                  <p style={{ fontWeight: \"bold\" }}>Inscription :&nbsp;</p>\r\n                  <p>{` ${new Date(created).toLocaleDateString('fr-FR')}`}</p>\r\n                </div>\r\n\r\n                <div className=\"container row\">\r\n                  <p style={{ fontWeight: \"bold\" }}>Email :&nbsp;</p>\r\n                  <p>{email}</p>\r\n                </div>\r\n\r\n                <div className=\"container row\">\r\n                  <p style={{ fontWeight: \"bold\" }}>Rôle favori :&nbsp;</p>\r\n                  <p>{role}</p>\r\n                </div>\r\n\r\n                <div className=\"container row\">\r\n                  <p style={{ fontWeight: \"bold\" }}>Loisirs :&nbsp;</p>\r\n                  <p>{hobbies}</p>\r\n                </div>\r\n              </div>\r\n              {isLoggedIn().user && isLoggedIn().user._id === _id && (\r\n                <div className=\"d-inline-block\">\r\n                  <Link\r\n                    to={`/post/create`}\r\n                    className=\"btn btn-raised btn-info mr-5 mb-3\"\r\n                  >\r\n                    Poster un message\r\n                  </Link>\r\n                  <Link\r\n                    to={`/user/edit/${_id}`}\r\n                    className=\"btn btn-raised btn-success mr-5 mb-3\"\r\n                  >\r\n                    Modifier les informations\r\n                  </Link>\r\n                  <DeleteUser userId={_id} />\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n          <div className=\"row\">\r\n            <div className=\"col-md-12 mt-5\">\r\n              <hr />\r\n              <p className=\"lead\">{about}</p>\r\n              <hr />\r\n\r\n              <UserPosts posts={posts} />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nexport default Profile;\r\n"]},"metadata":{},"sourceType":"module"}